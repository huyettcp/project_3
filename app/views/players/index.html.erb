<!DOCTYPE html>
<html>
  <head>    
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>Testing Pie Chart</title>

 
    <style type="text/css">
        .slice text {
            font-size: 16pt;
            font-family: Arial;
        }   
    </style>
  </head>
  <body>

      <div id="demo">
    <div id="buttons">
      <button id="data1" onclick="salaryDataSet()">Team Payroll</button>
      <button id="data2" onclick="costPerformanceScoreDataSet()">Team Performance</button>
    </div>

    </div>
    <script type="text/javascript">
   


function onLoadSalaryDataSet(){
   $.ajax({
    url: '/players',
    method: 'GET',
    dataType: 'json'
  }).done(function(player){

    console.log(player[1].name)

    var w = 600,                        //width
    h = 600,                            //height
    r = 300,                            //radius
    color = d3.scale.category20c();     //builtin range of colors
 
    salary_data = [{"label":player[0].name, "value":player[0].salary * .00001}, 
            {"label":player[1].name, "value":player[1].salary * .00001},  
            {"label":player[2].name, "value":player[2].salary * .00001}, 
            {"label":player[3].name, "value":player[3].salary * .00001},
            {"label":player[4].name, "value":player[4].salary * .00001},
            {"label":player[5].name, "value":player[5].salary * .00001},
            {"label":player[6].name, "value":player[6].salary * .00001},
            {"label":player[7].name, "value":player[7].salary * .00001},
            {"label":player[8].name, "value":player[8].salary * .00001},
            {"label":player[9].name, "value":player[9].salary * .00001}
            ];

    
    value_data = [{"label":player[0].name, "value":parseFloat(player[0].cost_performance_score) * .00001}
                  ];
    
    var vis = d3.select("body")
        .append("svg")              
        .data([salary_data])                   
        .attr("width", w)         
        .attr("height", h)
        .append("svg:g")                
        .attr("transform", "translate(" + r + "," + r + ")")   
    var arc = d3.svg.arc()              
        .outerRadius(r);
 
    var pie = d3.layout.pie()           
        .value(function(d) { return d.value; });    
 
    var arcs = vis.selectAll("g.slice")     
        .data(pie)                          
        .enter()                            
            .append("svg:g")               
                .attr("class", "slice");    
 
        arcs.append("svg:path")
                .attr("fill", function(d, i) { return color(i); } ) 
                .attr("d", arc);                                   
 
        arcs.append("svg:text")                                   
                .attr("transform", function(d) {                   
                d.innerRadius = 0;
                d.outerRadius = r;
                return "translate(" + arc.centroid(d) + ")";        
            })
            .attr("text-anchor", "middle")                          
            .text(function(d, i) { return salary_data[i].label; });
            })
 }

 function costPerformanceScoreDataSet(){
   $.ajax({
    url: '/players_sorted',
    method: 'GET',
    dataType: 'json'
  }).done(function(player){
    console.log(player[0].name)

    var w = 600,                        //width
        h = 600,                            //height
        r = 300,                            //radius
    color = d3.scale.category20c(); 

    value_data = [{"label":player[0].name, "value":parseFloat(player[0].cost_performance_score) * .00001},
                  {"label":player[1].name, "value":parseFloat(player[1].cost_performance_score) * .00001},
                  {"label":player[2].name, "value":parseFloat(player[2].cost_performance_score) * .00001},
                  {"label":player[3].name, "value":parseFloat(player[3].cost_performance_score) * .00001},
                  {"label":player[4].name, "value":parseFloat(player[4].cost_performance_score) * .00001},
                  {"label":player[5].name, "value":parseFloat(player[5].cost_performance_score) * .00001},
                  {"label":player[6].name, "value":parseFloat(player[6].cost_performance_score) * .00001},
                  {"label":player[7].name, "value":parseFloat(player[7].cost_performance_score) * .00001},
                  {"label":player[8].name, "value":parseFloat(player[8].cost_performance_score) * .00001},
                  {"label":player[9].name, "value":parseFloat(player[9].cost_performance_score) * .00001}

                  ];

    var vis = d3.select("svg")
        .append("svg")              
        .data([value_data])                   
        .attr("width", w)         
        .attr("height", h)
        .append("svg:g")                
        .attr("transform", "translate(" + r + "," + r + ")")   
    var arc = d3.svg.arc()              
        .outerRadius(r);
 
    var pie = d3.layout.pie()           
        .value(function(d) { return d.value; });    
 
    var arcs = vis.selectAll("g.slice")     
        .data(pie)                          
        .enter()                            
            .append("svg:g")               
                .attr("class", "slice");    
 
        arcs.append("svg:path")
                .attr("fill", function(d, i) { return color(i); } ) 
                .attr("d", arc);                                   
 
        arcs.append("svg:text")                                   
                .attr("transform", function(d) {                   
                d.innerRadius = 0;
                d.outerRadius = r;
                return "translate(" + arc.centroid(d) + ")";        
            })
            .attr("text-anchor", "middle")                          
            .text(function(d, i) { return value_data[i].label; });
            })

}

function salaryDataSet(){
   $.ajax({
    url: '/players',
    method: 'GET',
    dataType: 'json'
  }).done(function(player){

    console.log(player[1].name)

    var w = 600,                        //width
    h = 600,                            //height
    r = 300,                            //radius
    color = d3.scale.category20c();     //builtin range of colors
 
    salary_data = [{"label":player[0].name, "value":player[0].salary * .00001}, 
            {"label":player[1].name, "value":player[1].salary * .00001},  
            {"label":player[2].name, "value":player[2].salary * .00001}, 
            {"label":player[3].name, "value":player[3].salary * .00001},
            {"label":player[4].name, "value":player[4].salary * .00001},
            {"label":player[5].name, "value":player[5].salary * .00001},
            {"label":player[6].name, "value":player[6].salary * .00001},
            {"label":player[7].name, "value":player[7].salary * .00001},
            {"label":player[8].name, "value":player[8].salary * .00001},
            {"label":player[9].name, "value":player[9].salary * .00001}
            ];

    
    value_data = [{"label":player[0].name, "value":parseFloat(player[0].cost_performance_score) * .00001}
                  ];
    
    var vis = d3.select("svg")
        .append("svg")              
        .data([salary_data])                   
        .attr("width", w)         
        .attr("height", h)
        .append("svg:g")                
        .attr("transform", "translate(" + r + "," + r + ")")   
    var arc = d3.svg.arc()              
        .outerRadius(r);
 
    var pie = d3.layout.pie()           
        .value(function(d) { return d.value; });    
 
    var arcs = vis.selectAll("g.slice")     
        .data(pie)                          
        .enter()                            
            .append("svg:g")               
                .attr("class", "slice");    
 
        arcs.append("svg:path")
                .attr("fill", function(d, i) { return color(i); } ) 
                .attr("d", arc);                                   
 
        arcs.append("svg:text")                                   
                .attr("transform", function(d) {                   
                d.innerRadius = 0;
                d.outerRadius = r;
                return "translate(" + arc.centroid(d) + ")";        
            })
            .attr("text-anchor", "middle")                          
            .text(function(d, i) { return salary_data[i].label; });
            })
 }



window.onload=onLoadSalaryDataSet();


</script>

        
    </script>
  </body>
</html>
